
## Essential Docker Commands
 - `docker build` Build an image from a Dockerfile
 - `docker run` Create and run a new container from an image
 - `docker ps` List containers
 - `docker stop` Stop one or more running containers
 - `docker rm` Remove one or more containers
 - `docker rmi` Remove one or more images
 - `docker image` Manage images
  - `docker images` Lists all images stored locally
 - `docker pull` Downloads an image or a repository from a registry
 - `docker push` Uploads an image or a repository to a registry
 - `docker login` Authenticates to a Docker registry
 - `docker logout` Logs out from a Docker registry.
 - `docker exec` Runs a command in a running container
 - `docker logs` Fetches the logs of a container
 - `docker network` Manages networks
 - `docker volume` Manages volumes. Volumes are used to persist data generated by and used by Docker containers

 
 #### `docker build`
 Builds a Docker image from a Dockerfile. A Dockerfile contains a set of instructions for creating an image that includes the application, its dependencies, and runtime environments.

 ` docker build -t {image name} -f Dockerfile .`

 `docker build [OPTIONS] PATH | URL`
  - `PATH` specifies the location of the Dockerfile and related context (e.g., files used in the build).
  - `URL` can be used to specify a Git repository as the source of the Dockerfile and context.
  - `Optional parameters`
    - `-t`, `--tag`: Name and optionally a tag in the 'name:tag' format
    - `--build-arg` Set build-time variables
    - `--no-cache` Do not use cache when building the image.
    - `-f, --file` Name of the Dockerfile (Default is PATH/Dockerfile).

## Dockerfile
In summary, this Dockerfile defines a multi-stage build process where the first stage builds the .NET application, and the second stage prepares a lighter runtime environment to run the application.

```docker
FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build-env
WORKDIR /App

COPY . ./

RUN dotnet restore

RUN dotnet publish -c Release -o out

FROM mcr.microsoft.com/dotnet/aspnet:8.0
WORKDIR /App
COPY --from=build-env /App/out .
ENTRYPOINT ["dotnet", "{service name}.dll"]
```

`FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build-env` - This line is telling Docker to use the .NET SDK version 8.0 image from Microsoft's Container Registry as the base image for the build process.
  - `Container Registry` - Storage for container images. In the context of this file: It is Microsoft's own container registry designed to provide a globally available service for pulling Microsoft's container images.
  - `AS build-env` - Set a name to this stage to use it later like a variable.

`WORKDIR /App` - Sets the working directory inside the container to /App. This is the directory where your application's code will reside within the container during the build process.

`COPY . ./` - Copies everything from your project's folder (where the Dockerfile is located) into the current working directory inside the container (*/App*).

`RUN dotnet restore` - Executes the dotnet restore command. This command looks at the .NET project files in the container and downloads any dependencies (*libraries and packages*) that are needed to build the project.

`RUN dotnet publish -c Release -o out` - This command builds your .NET application in release mode (*optimized for production*) and outputs the compiled files to the *out* directory within the */App* directory in the container.
 - `-c Release` - The -c Release option specifies that the build should be done in Release configuration, which is optimized for performance.

`FROM mcr.microsoft.com/dotnet/aspnet:8.0` - After building the application, this line starts a new stage in the Dockerfile. It uses the .NET runtime image (*not the SDK*) version 8.0 as the base image. This image is lighter than the SDK image and is suitable for running the application but not for building it.

`WORKDIR /App` - Sets the working directory in this new stage (runtime stage) to */App*, similar to what was done in the build stage.

`COPY --from=build-env /App/out .` - Copies the compiled application from the out directory of the build-env (*the first stage*) to the current working directory (*/App*) of the current stage. This means we are transferring only the necessary files needed to run the application, leaving behind the source code, SDK, and any other unnecessary files.

`ENTRYPOINT ["dotnet", "{service name}.dll"]` - Specifies the command to run when the container starts. This is the main assembly that was compiled and published in the previous steps.
